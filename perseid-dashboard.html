 <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="//fonts.googleapis.com/css?family=Roboto:300,400,400italic,500,700" rel="stylesheet" type="text/css" />
    
    <title>perseid-dashboard</title>
    
</head>

<body>
    <div class="mui-container">
        <div class="mui-panel header">
            <h1>Perseid // Dashboard</h1>
        </div>

        {{> filter_form}}
       
        <div class="mui-panel">
            <h3>Count of Calls</h3>
            <canvas id="countOfCallsChart" width="400" height="80"></canvas>
        </div>
       
        <div class="mui-panel">       
            <h3>Last {{resentCallsLimit}} Calls</h3>
            <ul>
                {{#each resentCalls}}
                    {{> one_call}}
                {{/each}}
            </ul>
        </div>
        
        <div class="mui-panel">       
            <h3>Summary</h3>
            <ul>
                {{#each summaryRows}}
                    {{> summary_row}}
                {{/each}}
            </ul>
        </div>
        
    </div>
    
    {{> count_of_calls_js}}
    
</body>


<template name="filter_form">
        <div class="mui-panel filters">
            <form class="mui-form-inline mui-form-group" id="frmFilters">
                
                <input type="text" class="mui-form-control" id="txtContains" value="{{regex}}" />
                <label class="mui-form-floating-label" for="txtContains">
                    Show only contains ...
                </label>

                <div class="mui-select space-left space-right">
                    <select id="selLimit">
                        <option {{limitOf10}}>10</option>
                        <option {{limitOf20}}>20</option>
                        <option {{limitOf50}}>50</option>
                        <option {{limitOf100}}>100</option>
                        <option {{limitOf500}}>500</option>
                    </select>
                </div>

                <div class="mui-checkbox space-left space-right">
                    <label>
                        <input type="checkbox" checked="{{errorsOnly}}" id="chkErrors">
                        Errors only
                    </label>
                </div>                                                                
                
                <!--<button class="mui-btn mui-btn-default space-left">SUBMIT</button>-->
            </form>
        </div>
</template>


<template name="one_call">
    <li>
        <div class="mui-text-body1">
            [{{localTime StartTime}}] {{Method}} {{Url}}
        </div>
        {{#if Exception}}
            <div class="mui-text-body2 mui-text-accent">
                {{Exception.Message}}
            </div>
        {{/if}}
    </li>
</template>

<template name="summary_row">
    <li>
        <div class="mui-text-body1">
            [{{Count}}] {{Method}} {{Url}}
        </div>
    </li>
</template>

<template name="count_of_calls_js">
   
   
    <script>
    Chart.defaults.global.responsive = true;
    

    var data = {
        labels: ["January", "February", "March", "April", "May", "June", "July"],
        datasets: [
            {
                label: "API Calls",
                fillColor: "rgba(155,120,120,0.2)",
                strokeColor: "rgba(255,100,100,1)",
                pointColor: "rgba(151,187,205,1)",
                pointStrokeColor: "#fff",
                pointHighlightFill: "#fff",
                pointHighlightStroke: "rgba(251,107,205,1)",
                data: [28, 48, 40, 19, 86, 27, 90]
            }
        ]
    };   

    var ctx = document.getElementById("countOfCallsChart").getContext("2d");
    var myLineChart = new Chart(ctx).Line(data);

    </script>
    
</template>